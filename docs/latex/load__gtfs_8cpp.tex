\hypertarget{load__gtfs_8cpp}{}\section{src/load\+\_\+gtfs.cpp File Reference}
\label{load__gtfs_8cpp}\index{src/load\+\_\+gtfs.\+cpp@{src/load\+\_\+gtfs.\+cpp}}
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$fstream$>$}\newline
{\ttfamily \#include $<$algorithm$>$}\newline
{\ttfamily \#include $<$boost/program\+\_\+options.\+hpp$>$}\newline
{\ttfamily \#include $<$sqlite3.\+h$>$}\newline
{\ttfamily \#include \char`\"{}gps.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gtfs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}json.\+hpp\char`\"{}}\newline
Include dependency graph for load\+\_\+gtfs.\+cpp\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{load__gtfs_8cpp__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{load__gtfs_8cpp_acc289d9bfee4c154322662aef55c5438}{system} (std\+::string const \&s)
\item 
void \hyperlink{load__gtfs_8cpp_a4f311128b9bf5549011dc5d2a288a0b0}{convert\+\_\+shapes} (sqlite3 $\ast$db)
\item 
void \hyperlink{load__gtfs_8cpp_a54ef9ab4a1985152c9cf7ec290fbea2d}{import\+\_\+intersections} (sqlite3 $\ast$db, std\+::vector$<$ std\+::string $>$ files)
\item 
void \hyperlink{load__gtfs_8cpp_afc0ec9cd72ffe92b7aacb7c58aeea6b3}{calculate\+\_\+stop\+\_\+distances} (std\+::string \&dbname)
\item 
int \hyperlink{load__gtfs_8cpp_a0ddf1224851353fc92bfbff6f499fa97}{main} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Load the most recent G\+T\+FS static data from Auckland Transport.

This program will populate the supplied database with the most recent version of the G\+T\+FS static feed from Auckland Transport.

Segmentation will take place, in which shapes are split at intersections. Routes will be compared to existing routes, and if there are no changes the segments will simply be duplicated; otherwise new segments will be created.

\begin{DoxyAuthor}{Author}
Tom Elliott \href{mailto:tom.elliott@auckland.ac.nz}{\tt tom.\+elliott@auckland.\+ac.\+nz} 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+0.\+1 
\end{DoxyVersion}


\subsection{Function Documentation}
\mbox{\Hypertarget{load__gtfs_8cpp_afc0ec9cd72ffe92b7aacb7c58aeea6b3}\label{load__gtfs_8cpp_afc0ec9cd72ffe92b7aacb7c58aeea6b3}} 
\index{load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}!calculate\+\_\+stop\+\_\+distances@{calculate\+\_\+stop\+\_\+distances}}
\index{calculate\+\_\+stop\+\_\+distances@{calculate\+\_\+stop\+\_\+distances}!load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}}
\subsubsection{\texorpdfstring{calculate\+\_\+stop\+\_\+distances()}{calculate\_stop\_distances()}}
{\footnotesize\ttfamily void calculate\+\_\+stop\+\_\+distances (\begin{DoxyParamCaption}\item[{std\+::string \&}]{dbname }\end{DoxyParamCaption})}

Compute the shape distance traveled for each stop along a route. 
\begin{DoxyParams}{Parameters}
{\em dbname} & The database to connect to \\
\hline
\end{DoxyParams}
T\+H\+EN, see if stop lies between stop i-\/1 and stop i actually, since AT joins route shapes to the stop, we don\textquotesingle{}t need to do this bit\mbox{\Hypertarget{load__gtfs_8cpp_a4f311128b9bf5549011dc5d2a288a0b0}\label{load__gtfs_8cpp_a4f311128b9bf5549011dc5d2a288a0b0}} 
\index{load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}!convert\+\_\+shapes@{convert\+\_\+shapes}}
\index{convert\+\_\+shapes@{convert\+\_\+shapes}!load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}}
\subsubsection{\texorpdfstring{convert\+\_\+shapes()}{convert\_shapes()}}
{\footnotesize\ttfamily void convert\+\_\+shapes (\begin{DoxyParamCaption}\item[{sqlite3 $\ast$}]{db }\end{DoxyParamCaption})}

Converts shapes from their raw G\+T\+FS format to our segmented format.

For now, each shape is simply converted into a single segment. 
\begin{DoxyParams}{Parameters}
{\em db} & the database to work with \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{load__gtfs_8cpp_a54ef9ab4a1985152c9cf7ec290fbea2d}\label{load__gtfs_8cpp_a54ef9ab4a1985152c9cf7ec290fbea2d}} 
\index{load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}!import\+\_\+intersections@{import\+\_\+intersections}}
\index{import\+\_\+intersections@{import\+\_\+intersections}!load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}}
\subsubsection{\texorpdfstring{import\+\_\+intersections()}{import\_intersections()}}
{\footnotesize\ttfamily void import\+\_\+intersections (\begin{DoxyParamCaption}\item[{sqlite3 $\ast$}]{db,  }\item[{std\+::vector$<$ std\+::string $>$}]{files }\end{DoxyParamCaption})}

Import insersections from a J\+S\+ON file into the database.

Additionally, clusters of \char`\"{}points\char`\"{} belonging to the same intersection are combined into a single object.


\begin{DoxyParams}{Parameters}
{\em db} & the database to use \\
\hline
{\em files} & the files to load intersections from \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{load__gtfs_8cpp_a0ddf1224851353fc92bfbff6f499fa97}\label{load__gtfs_8cpp_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}!main@{main}}
\index{main@{main}!load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

Loads G\+T\+FS file into database and segments as necessary.


\begin{DoxyParams}{Parameters}
{\em argc} & number of command line arguments \\
\hline
{\em argv} & arguments \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if everything went OK; 1 if it didn\textquotesingle{}t 
\end{DoxyReturn}
database connection to use \mbox{\Hypertarget{load__gtfs_8cpp_acc289d9bfee4c154322662aef55c5438}\label{load__gtfs_8cpp_acc289d9bfee4c154322662aef55c5438}} 
\index{load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}!system@{system}}
\index{system@{system}!load\+\_\+gtfs.\+cpp@{load\+\_\+gtfs.\+cpp}}
\subsubsection{\texorpdfstring{system()}{system()}}
{\footnotesize\ttfamily int system (\begin{DoxyParamCaption}\item[{std\+::string const \&}]{s }\end{DoxyParamCaption})}

A \hyperlink{load__gtfs_8cpp_acc289d9bfee4c154322662aef55c5438}{system()} command that takes a std\+::string instead of a char. 
\begin{DoxyParams}{Parameters}
{\em s} & The command to run. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The return value from the system command. 
\end{DoxyReturn}
